source = "#include <iostream>\n"+"#include <stdio.h>\n"+"#include \"SDL.h\"\n"+"\n"+"int mouseState = 0;\n"+"\n"+"#include \"core/header/types.hpp\"\n"+"#include \"core/header/spec.hpp\"\n"+"#include \"core/ram.cpp\"\n"+"#include \"core/disp.cpp\"\n"+"#include \"core/text.cpp\"\n"+"\n"+"CPT_Screen scr(vram);\n"+"Font font(scr);\n"+"\n"+"#include \"lua_api.cpp\"\n"+"#include \"core/sound.cpp\"\n"+"\n"+"void cpt_init(int argv, char** args) {\n"+"    if (argv == 1) {\n"+"        throw \"Please specify lua source path.\";\n"+"    }\n"+"    std::string opening_msg = \n"+"    \"+------------------------------------------------+\n\"\n"+"    \"|  CPT100 High-spec Fantasy Console              |\n\"\n"+"    \"|                                                |\n\"\n"+"    \"|  (c) src3453 2023 Released under MIT Licence.  |\n\"\n"+"    \"+------------------------------------------------+\n\"\n"+"    ;\n"+"    std::cout << opening_msg << std::endl;\n"+"    ram_boot(ram, vram);\n"+"    scr.init();\n"+"    if (argv >= 1) {\n"+"        init_lua(args[1]);\n"+"    } else {\n"+"        throw \"Please Specify Lua Source Path.\";\n"+"    }\n"+"    initSound();\n"+"    //Set callback\n"+"}\n"+"\n"+"void blitToMainWindow(SDL_Texture *texture, SDL_Renderer *renderer, uint8_t *pixels) {\n"+"    \n"+"    \n"+"    // update texture with new data\n"+"    int texture_pitch = 0;\n"+"    void* texture_pixels = NULL;\n"+"    if (SDL_LockTexture(texture, NULL, &texture_pixels, &texture_pitch) != 0) {\n"+"        SDL_Log(\"Unable to lock texture: %s\", SDL_GetError());\n"+"    }\n"+"    else {\n"+"        memcpy(texture_pixels, pixels, texture_pitch * CPT_SCREEN_HEIGHT);\n"+"    }\n"+"    SDL_UnlockTexture(texture);\n"+"    SDL_RenderCopy(renderer, texture, NULL, NULL);\n"+"}\n"+"\n"+"uint8_t finalPixels[CPT_SCREEN_WIDTH * CPT_SCREEN_HEIGHT * 3] = {0};\n"+"\n"+"void MainTick(SDL_Texture* texture, SDL_Renderer* renderer) {\n"+"    lua[\"LOOP\"](); //60Hz\n"+"    scr.update(finalPixels);\n"+"    blitToMainWindow(texture, renderer, finalPixels);\n"+"}\n"+"\n"+"\n"+"\n"+"int main(int argv, char** args) {\n"+"    \n"+"    \n"+"    SDL_Init(SDL_INIT_EVERYTHING);\n"+"    \n"+"    SDL_Window* window;\n"+"    SDL_Renderer* renderer;\n"+"    window = SDL_CreateWindow(\"CPT100 High-spec Fantasy Console\", SDL_WINDOWPOS_UNDEFINED, SDL_WINDOWPOS_UNDEFINED, CPT_SCREEN_WIDTH, CPT_SCREEN_HEIGHT, SDL_WINDOW_SHOWN);\n"+"    renderer = SDL_CreateRenderer(window, -1, SDL_RENDERER_ACCELERATED);\n"+"    \n"+"    bool isRunning = true;\n"+"\n"+"    cpt_init(argv,args);\n"+"    \n"+"    SDL_Texture *texture = SDL_CreateTexture(\n"+"        renderer,\n"+"        SDL_PIXELFORMAT_RGB24,\n"+"        SDL_TEXTUREACCESS_STREAMING,\n"+"        CPT_SCREEN_WIDTH,\n"+"        CPT_SCREEN_HEIGHT);\n"+"        if (texture == NULL) {\n"+"            SDL_Log(\"Unable to create texture: %s\", SDL_GetError());\n"+"            return 1;\n"+"        }\n"+"\n"+"    while (isRunning) {\n"+"\n"+"        SDL_Event event;\n"+"        while (SDL_PollEvent(&event) != 0) {\n"+"            if (event.type == SDL_QUIT) {\n"+"                isRunning = false;\n"+"            }\n"+"            if (event.type == SDL_KEYDOWN) {\n"+"                Lua_OnKeyDown((int)SDL_GetScancodeFromKey(event.key.keysym.sym));\n"+"            }\n"+"            if (event.type == SDL_KEYUP) {\n"+"                Lua_OnKeyUp((int)SDL_GetScancodeFromKey(event.key.keysym.sym));\n"+"            }\n"+"            if (event.type == SDL_MOUSEBUTTONDOWN) \n"+"            {\n"+"                if(event.button.button == SDL_BUTTON_LEFT){\n"+"                    mouseState += 1;\n"+"                }\n"+"                else if(event.button.button == SDL_BUTTON_RIGHT){\n"+"                    mouseState += 2;\n"+"                }\n"+"                else if(event.button.button == SDL_BUTTON_MIDDLE){\n"+"                    mouseState += 4;\n"+"                }\n"+"            }\n"+"            if (event.type == SDL_MOUSEBUTTONUP) \n"+"            {\n"+"                if(event.button.button == SDL_BUTTON_LEFT){\n"+"                    mouseState -= 1;\n"+"                }\n"+"                else if(event.button.button == SDL_BUTTON_RIGHT){\n"+"                    mouseState -= 2;\n"+"                }\n"+"                else if(event.button.button == SDL_BUTTON_MIDDLE){\n"+"                    mouseState -= 4;\n"+"                }\n"+"            }\n"+"        }\n"+"\n"+"        SDL_RenderClear(renderer);\n"+"        \n"+"        MainTick(texture,renderer);\n"+"\n"+"        SDL_RenderPresent(renderer);\n"+"        //SDL_Delay(1000/CALLBACK_FPS);\n"+"    }\n"+"\n"+"    SDL_DestroyRenderer(renderer);\n"+"    SDL_DestroyWindow(window);\n"+"    SDL_CloseAudioDevice(dev);\n"+"    SDL_Quit();\n"+"    \n"+"    return 0;\n"+"}\n"+"\n";